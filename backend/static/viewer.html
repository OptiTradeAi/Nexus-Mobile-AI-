<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Nexus Mobile AI - Viewer</title>
<style>
body{margin:0;background:#0a0f20;color:#fff;font-family:sans-serif;display:flex;flex-direction:column;height:100vh}
#header{padding:10px;background:#0005}
#status{font-weight:700}
#content{flex:1;display:flex;justify-content:center;align-items:center;background:#000}
#content img{max-width:100%;max-height:100%}
</style>
</head>
<body>

<div id="header">
  <span id="status">Conectando...</span> - 
  <span id="info"></span>
</div>

<div id="content"><span>Nenhum frame recebido</span></div>

<script>
const statusEl=document.getElementById("status");
const infoEl=document.getElementById("info");
const contentEl=document.getElementById("content");

const proto=location.protocol==="https:"?"wss":"ws";
const ws=new WebSocket(proto+"://"+location.host+"/ws/viewer");

ws.onopen=()=>statusEl.textContent="Conectado ✔";
ws.onclose=()=>statusEl.textContent="Desconectado ✖";

ws.onmessage=(ev)=>{
  const msg=JSON.parse(ev.data);
  if(msg.type==="frame"){
    contentEl.innerHTML="<img id='img'>";
    const img=document.getElementById("img");
    img.src="data:"+msg.mime+";base64,"+msg.data;
    infoEl.textContent="Par "+msg.pair+" | "+(msg.analysis?.suggested_action||"")+" | "+new Date().toLocaleTimeString();
  }
};
</script>

</body>
</html>
