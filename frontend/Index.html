<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nexus Mobile AI - Espelhamento HomeBroker</title>
<script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
<style>
  body { background:#0f111a; color:#fff; font-family:Arial; margin:0; overflow:hidden; }
  #chart { width:100vw; height:100vh; }
  .signal {
    position:absolute; top:10px; right:10px;
    background:#00ff99; color:#000;
    padding:10px; border-radius:10px;
    font-weight:bold; display:none;
  }
</style>
</head>
<body>
<div id="chart"></div>
<div class="signal" id="signalBox">SINAL GERADO</div>

<script>
const chart = LightweightCharts.createChart(document.getElementById('chart'), {
    layout: { background: { color: '#0f111a' }, textColor: '#fff' },
    grid: { vertLines: { color: '#2c2c2c' }, horzLines: { color: '#2c2c2c' } },
});
const candleSeries = chart.addCandlestickSeries();

const ws = new WebSocket("wss://nexus-mobile-ai.onrender.com/ws");
const signalBox = document.getElementById('signalBox');

ws.onmessage = (event) => {
    const msg = JSON.parse(event.data);
    if (msg.type === "candle") {
        const d = msg.data;
        candleSeries.update({
            time: Math.floor(Date.now() / 1000),
            open: d.open,
            high: d.high,
            low: d.low,
            close: d.close,
        });
    } else if (msg.type === "signal") {
        signalBox.style.display = "block";
        signalBox.innerText = `SINAL: ${msg.data.pair} | ${Math.round(msg.data.confidence*100)}%`;
        setTimeout(() => signalBox.style.display = "none", 3000);
    }
};
</script>
</body>
</html>
